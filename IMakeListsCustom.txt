set(CMAKE_BUILD_TYPE Debug)

set(CMAKE_CXX_FLAGS  "${CMAKE_CXX_FLAGS} -g")

find_package(MagnumIntegration REQUIRED ImGui)
find_package(Magnum REQUIRED
                    GL
                    MeshTools
                    Primitives
                    SceneGraph
                    Sdl2Application
                    Shaders
                    Trade
                    )

set_directory_properties(PROPERTIES CORRADE_USE_PEDANTIC_FLAGS ON)

add_subdirectory(src)

corrade_add_resource(xxx_RESOURCES src/resources.conf)

add_executable(xxx src/xxx.cpp ${xxx_RESOURCES})
target_link_libraries(xxx PRIVATE
    broker
    caf_core
    Magnum::Application
    Magnum::GL
    Magnum::Magnum
    Magnum::MeshTools
    Magnum::Primitives
    Magnum::SceneGraph
    Magnum::Shaders
    Magnum::Trade
    MagnumIntegration::ImGui
    ${LIBEPAN_LIBS}
    )

register_tap_files(ebc-tap-register.c
   ${TSHARK_TAP_SRC}
)

set(EBC_FILES
    capture_opts.c
    ebc-tap-register.c
    src/ebc.cpp
    ${TSHARK_TAP_SRC}
    ${SHARK_COMMON_SRC}
)

add_executable(ebc ${EBC_FILES})

set(EBC_LIBS
    ui
    capchild
    caputils
    ${LIBEPAN_LIBS}
    ${GLIB2_LIBRARIES}
    ${APPLE_CORE_FOUNDATION_LIBRARY}
    ${APPLE_SYSTEM_CONFIGURATION_LIBRARY}
)

target_link_libraries(ebc
    Magnum::Application
    Magnum::GL
    Magnum::Magnum
    ${EBC_LIBS}
    )

target_compile_options(xxx PRIVATE)

set_target_properties(xxx ebc
  PROPERTIES
  RUNTIME_OUTPUT_DIRECTORY "${CMAKE_BINARY_DIR}/bin")
