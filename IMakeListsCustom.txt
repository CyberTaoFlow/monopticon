find_package(MagnumIntegration REQUIRED ImGui)
find_package(Magnum REQUIRED
                    GL
                    MeshTools
                    Primitives
                    SceneGraph
                    Sdl2Application
                    Shaders
                    Trade
                    )

set_directory_properties(PROPERTIES CORRADE_USE_PEDANTIC_FLAGS ON)

add_subdirectory(src)

add_executable(xxx src/xxx.cpp)
target_link_libraries(xxx PRIVATE
    Magnum::Application
    Magnum::GL
    Magnum::Magnum
    Magnum::MeshTools
    Magnum::Primitives
    Magnum::SceneGraph
    Magnum::Shaders
    Magnum::Trade
    MagnumIntegration::ImGui
    ${LIBEPAN_LIBS}
    )

message(STATUS "----------------------------------")
message(STATUS ${LIBEPAN_LIBS})
message(STATUS ${PCAP_LIBRARIES})
message(STATUS ${GLIB2_LIBRARIES})
message(STATUS ${TSHARK_TAP_SRC})
message(STATUS ${APPLE_CORE_FOUNDATION_LIBRARY})
message(STATUS "----------------------------------")
message(STATUS "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx")
message(STATUS ${HAVE_LIBPCAP})
message(STATUS "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx")

register_tap_files(ebc-tap-register.c ${TSHARK_TAP_SRC})

set(ebc_FILES
    capture_opts.c
    ebc-tap-register.c
    ebc.cpp
    ${TSHARK_TAP_SRC}
    ${SHARK_COMMON_SRC}
)

add_executable(ebc ${ebc_FILES})


set(EBC_LIBS
    ui
    capchild
    caputils
    ${LIBEPAN_LIBS}
    ${GLIB2_LIBRARIES}
    ${APPLE_CORE_FOUNDATION_LIBRARY}
    ${APPLE_SYSTEM_CONFIGURATION_LIBRARY}
)

add_dependencies(ebc version)
set_extra_executable_properties(ebc "Executables")

target_link_libraries(ebc
    Magnum::Application
    Magnum::GL
    Magnum::Magnum
    ${EBC_LIBS}
    )

set_target_properties(xxx ebc
  PROPERTIES
  RUNTIME_OUTPUT_DIRECTORY "${CMAKE_BINARY_DIR}/bin")
